# Power App - James Jp
_Updated on:8/4/2024, 7:18:09 PM_

## [Power Apps Designer ](https://make.powerapps.com/environments/a81ef750-ae72-4167-8add-ba8d028c0fc4/home)

## Frequent used links
| [Control and Properties](https://learn.microsoft.com/en-us/power-apps/maker/canvas-apps/reference-properties) | [Formula reference](https://learn.microsoft.com/en-us/power-platform/power-fx/formula-reference-canvas-apps) | [Popular Connectors](https://learn.microsoft.com/en-us/power-apps/maker/canvas-apps/connections/connection-excel) | [model-driven apps documentation](https://learn.microsoft.com/en-us/power-apps/maker/model-driven-apps/) ðŸ”– | []() | []() | []() |

## ðŸ“ŒLEARN

### Nokia
* [Nokia Approved Connector](https://nokia.sharepoint.com/sites/ITServices/Lists/Power%20Platform%20Connectors/AllItems.aspx)
* [Custom connectors overview | Microsoft](https://learn.microsoft.com/en-us/connectors/custom-connectors/)

### Microsoft Learn
* ðŸš©[Model-driven apps customization using code](https://learn.microsoft.com/en-us/power-apps/developer/model-driven-apps/supported-customizations)
* [model-driven app designers](https://learn.microsoft.com/en-us/power-apps/maker/model-driven-apps/model-driven-designers) - the page describe the model driven app designer and their user scenarios
* [Power APPs community blogs](https://community.powerplatform.com/blogs/?groupid=b5652dc6-2c99-4e33-8b6f-45be4a896a40)
* [Power Platform admin center](https://admin.powerplatform.microsoft.com/home)
* [Power Apps | Microsoft Learn](https://learn.microsoft.com/en-us/training/browse/?terms=%22power%20apps%22&resource_type=module)

### Youtube

* [[YouTube][Reza] Microsoft Dataverse Serials](https://www.youtube.com/watch?v=YL4CGQj7z3s&list=PLTyFh-qDKAiHr7HwkvlHXpCNf73xNBqj_&index=3)

### Websites
* [Power Apps in spguides.com](https://www.spguides.com/power-apps/) - includes advance tutorials for Power Apps Functions, Controls, Errors handling and working with TEAMs and Dataverse etc examples
* [Practical Power Apps](https://www.practicalpowerapps.com/useful-tips/) - Practical Power Apps deals primarily with users wanting to set up their Power Apps structure using SharePoint as the data source and Canvas Apps and Power Automate.
* [Matthew Devaney Power Apps Tutorials ](https://www.matthewdevaney.com/) - No Ads, No Fluff, Just Power Apps Stuff

### Useful Cases

* [Power Apps Patch Function Examples For Every SharePoint Column Type](https://www.matthewdevaney.com/power-apps-patch-function-examples-for-every-sharepoint-column-type/)
* ðŸ’¥[20+ More Power Apps Chart Types With QuickChart](https://www.matthewdevaney.com/add-more-power-apps-chart-types-with-quickchart/#:~:text=Go%20to%20QuickChart%20and%20open%20the%20Chart%20Gallerypage) - how to add more Power Apps chart types by using Quickchart
* [Walkthrought: Write you first client script | Microsoft Learn](https://learn.microsoft.com/en-us/power-apps/developer/model-driven-apps/clientapi/walkthrough-write-your-first-client-script) - Use JavaScript code in model-driven apps
* [Client API Reference for model-driven apps](https://learn.microsoft.com/en-us/power-apps/developer/model-driven-apps/clientapi/reference)
* [7 Ways To Use The PATCH Function In Power Apps](https://www.matthewdevaney.com/7-ways-to-use-the-patch-function-in-power-apps-cheat-sheet/)
* Find step-by-step procedures for configuring common controls such as [screens](https://learn.microsoft.com/en-us/power-apps/maker/canvas-apps/add-screen-context-variables), [lists](https://learn.microsoft.com/en-us/power-apps/maker/canvas-apps/add-list-box-drop-down-list-radio-button), [galleries](https://learn.microsoft.com/en-us/power-apps/maker/canvas-apps/add-gallery), [forms](https://learn.microsoft.com/en-us/power-apps/maker/canvas-apps/add-form), and [charts](https://learn.microsoft.com/en-us/power-apps/maker/canvas-apps/use-line-pie-bar-chart).
* [Display Image from SPO List](https://www.spguides.com/display-images-from-a-sharepoint-online-library-in-powerapps/)
* [Canvas app forms](https://learn.microsoft.com/en-us/power-apps/maker/canvas-apps/working-with-forms) - Example on usage of Gallery and Forms for new and updates of record in SharePoint or other data source.


### Card

* [Cards for Power Apps](https://learn.microsoft.com/en-us/power-apps/cards/overview)

### Power Fx

* [Use advanced formula techniques and custom updates in Power Platform](https://learn.microsoft.com/en-us/training/paths/understand-advanced-topics/)
* [Patch](https://learn.microsoft.com/en-us/power-apps/maker/canvas-apps/functions/function-patch) | [Collect](https://learn.microsoft.com/en-us/power-apps/maker/canvas-apps/functions/function-clear-collect-clearcollect) | [Update](https://learn.microsoft.com/en-us/power-apps/maker/canvas-apps/functions/function-update-updateif) |

### Dataverse Web API
Microsoft
* [Dataverse developer documentation | Microsoft Learn](https://learn.microsoft.com/en-us/power-apps/developer/data-platform/)
* [Dataverse Microsoft Learning Course List](https://learn.microsoft.com/en-us/training/browse/?resource_type=learning%20path&products=power-apps&terms=dataverse)
* [MS Dataverse Web API Resource](https://learn.microsoft.com/en-us/power-apps/developer/data-platform/webapi/query/overview)ðŸš©
* [Perform operations using the Web API](https://learn.microsoft.com/en-us/power-apps/developer/data-platform/webapi/perform-operations-web-api)

Tutorials on Web
* [Easily connect to Dataverse/Microsoft Dynamics with Python](https://andyhowes.co/easily-connect-to-dataverse-microsoft-dynamics-with-python/) - [Code Example in Github](https://github.com/YesWeCandrew/PyConnectDataverse/tree/master)

### SharePoint

* [SharePoint Calculated Column](https://support.microsoft.com/en-us/office/calculated-value-for-a-list-column-45903d26-5eee-49ec-b94c-9376bd8c2680)
* [Show list columns in a gallery](https://learn.microsoft.com/en-us/power-apps/maker/canvas-apps/connections/connection-sharepoint-online#show-list-columns-in-a-gallery) - how to show data from Microsoft Lists or SharePoint (such as dates, choices, and people) in a gallery
* [Edit form and Display form controls](https://learn.microsoft.com/en-us/power-apps/maker/canvas-apps/controls/control-form-detail) - How to show data in a form (with drop-down lists, date pickers, and people pickers): 

### QuickChart
* [Quick Chart Gallery](https://quickchart.io/gallery/) - support to build customized chart for Power Apps

## ðŸ“ŒPRACTICE

### Playground / Demonstration 

* Just for Try >> [Power App Designer](https://make.powerapps.com/e/a81ef750-ae72-4167-8add-ba8d028c0fc4/canvas/?action=new-blank&form-factor=tablet&name=JustForTry_01)

* Asset Management APP >> | [Asset - SharePoint DataSource](https://nokia.sharepoint.com/sites/JamesJpZhang/Lists/Asset/AllItems.aspx) |+|  [App Designer](https://make.powerapps.com/e/a81ef750-ae72-4167-8add-ba8d028c0fc4/canvas/?action=edit&app-id=%2Fproviders%2FMicrosoft.PowerApps%2Fapps%2F984ad30c-dc3f-496e-b927-d6129ac78cd7) |

* Microsoft DataSet >> [Install Northwind Traders database and apps](https://learn.microsoft.com/en-us/power-apps/maker/canvas-apps/northwind-install)

### sample data
```js
ClearCollect( IceCream,
  { ID: 1, Flavor: "Chocolate",  Quantity: 100 },
  { ID: 2, Flavor: "Vanilla",    Quantity: 200 },
  { ID: 3, Flavor: "Strawberry", Quantity: 300 }
)

//Create a collection
ClearCollect(Fruit,
    {Item: "Apples", Quantity: 30},
    {Item: "Oranges", Quantity: 12},
    {Item: "Bananas", Quantity: 27},
    {Item: "Grapes", Quantity: 22},
    {Item: "Kiwis", Quantity: 8}
);
```

## ðŸ“ŒPROGRESS

### ToDo

* [Cross-Origin Resource Sharing (CORS) support for Azure Storage](https://learn.microsoft.com/en-us/rest/api/storageservices/cross-origin-resource-sharing--cors--support-for-the-azure-storage-services)


ðŸ”¸ðŸ”¸ðŸ”¸ðŸ”¸ðŸ”¸ðŸ”¸ðŸ”¸ðŸ”¸ðŸ”¸ðŸ”¸ðŸ”¸ðŸ”¸ðŸ”¸ðŸ”¸ðŸ”¸ðŸ”¸ðŸ”¸ðŸ”¸ðŸ”¸ðŸ”¸ðŸ”¸ðŸ”¸ðŸ”¸ðŸ”¸ðŸ”¸ðŸ”¸ðŸ”¸ðŸ”¸ðŸ”¸ðŸ”¸ðŸ”¸ðŸ”¸

## General

### Power App hyperlink

Syntax
> Launch( "https://apps.powerapps.com/e/{environment id}/a/{app id}?tenantId={tenantId}" )

```js
https://apps.powerapps.com/play/e/a81ef750-ae72-4167-8add-ba8d028c0fc4/a/5f04558b-cabe-416b-b2f9-34597b38f159?tenantId=5d471751-9675-428d-917b-70f44f9630b0&sourcetime=1722821310933
```

### Single Quotes vs Double Quotes

[Operators and Identifiers in Power Apps - Power Platform | Microsoft Learn](https://learn.microsoft.com/en-us/power-platform/power-fx/reference/operators#disambiguation-operator)

Use single quotes around a name that contains a space or other special character.
Double quotes are used to designate text strings.

Single quotes are required when referencing the value of an object, such as a field or table, in which the name of the object contains a space. Double quotes are used when we are not referencing the value of an object but instead talking about it, especially in situations in which the object does not yet exist, as in the case of AddColumns.

```js
ShowColumns(
    AddColumns(
        Filter( Products, 'Quantity Requested' > 'Quantity Available' ),
        "Quantity To Order", 'Quantity Requested' - 'Quantity Available'
    ),
    "Product",
    "Quantity To Order"
)
```

### Disambiguation operator
Some functions create record scopes for accessing the fields of table while processing each record, such as Filter, AddColumns, and Sum. Field names added with the record scope override the same names from elsewhere in the app. When this happens, you can still access values from outside the record scope with the @ disambiguation operator:

- To access values from nested record scopes, use the @ operator with the name of the table being operated upon using this pattern:
Table[@FieldName]
- To access global values, such as data sources, collections, and context variables, use the pattern [@ObjectName] (without a table designation).

## Naming Conventions
<https://learn.microsoft.com/en-us/power-apps/guidance/coding-guidelines/code-readability>

Camel case - for controls and variables, e.g. `txtUserEmailAddress` for text input control
Pascal case - for data sources, e.g. `Office365Users`

* Screen - end with "Screen", e.g. Home_Screen, Search Screen
* Control - names should begin with three-character type description, followed by purpose of control, e.g. `lblUserName` indicates that the control is a label
* Excel DataTables - use Pascal casing,e.g. `EmployeeLeaveRequests`. Use one DataTable per worksheet. 
* Variables:
  * Global variable: `gblFocusedBorderColor`
  * Context variable: `locSuccessMessage`
  * Scope variable: `scpRadius`
  * Text/string variable: `strUserName`
  * numeric variable: `numTotalAmount`
  * form variables: `frm`
  * collections: `col`


## Function, Formular

### Error Handling

* [App object in Power Apps](https://learn.microsoft.com/en-us/power-platform/power-fx/reference/object-app#onerror-property)
* [Trace function](https://learn.microsoft.com/en-us/power-platform/power-fx/reference/function-trace)
* [Error, IfError, IsError, and IsBlankOrError](https://learn.microsoft.com/en-us/power-platform/power-fx/reference/function-iferror)


Assume slider1.value will be Zero, which will trigger the error of "Invalid operation: division by zero."

```js
Label1.Text = IfError( 1/Slider1.Value, 0 )
```
If we add an OnError handler, it will have no impact before step 5, but it can impact how the error is reported:

```js
Trace( $"Error {FirstError.Message} in {FirstError.Source}" );
Error( FirstError )
```

### Concurrent

```js
Concurrent(
    ClearCollect(colAccounts1, Accounts),
    ClearCollect(colUsers1, Users),
    ClearCollect(colEnvDef1, 'Environment Variable Definitions'),
    ClearCollect(colEnvVal1, 'Environment Variable Values')
);
```

### Coalesce
The Coalesce function evaluates its arguments in order and returns the first value that isn't blank or an empty string. 

```js
Coalesce(value1, value2)
```


### ShowColumns

When optimizing data loading in Power Apps, you might want to fetch and display only the necessary columns in a gallery rather than retrieving the entire dataset.

```js
// Bind the gallery to display only the "ProductName" and "QuantitySold" columns
Gallery1.Items = ShowColumns(ProductSales, ProductName, QuantitySold)
```

### Hashtags

* [HashTags function](https://learn.microsoft.com/en-us/power-platform/power-fx/reference/function-hashtags) - Extracts the hashtags (#strings) from a string of text.

### ForAll

```js
Concat(Sequence(5),Value,",")  // return 1,2,3,4,5
ForAll(Sequence(3), Power(Value,2)) // return Table({value:1},{value:4},{value:9})
```

### Concat

```js
Concat(Sequence(5),Value,",")  // return 1,2,3,4,5
```

```js
// Button.OnSelect = 
ClearCollect( IceCream,
              { ID: 1, Flavor: "Chocolate",  Quantity: 100 },
              { ID: 2, Flavor: "Vanilla",    Quantity: 200 },
              { ID: 3, Flavor: "Strawberry", Quantity: 300 }
)

// htmlText.HtmlText = 
Concat(IceCream, $"{ID} : {Flavor} {Quantity}","<br>")
```
Output
![Concat](image/20240805234105.png)


### With

```js
With( { radius: 10,
        height: 15 },
    Pi() * (radius*radius) * height
)
// Result: 4712.38898038 (as shown in a label control)
```


### IsMatch, Match, MatchAll
[IsMatch](https://learn.microsoft.com/en-us/power-platform/power-fx/reference/function-ismatch)

Assume here TextInput1.text =  "Hello world"

```js
// Tests whether the user's input contains the word "hello" (case sensitive).	
IsMatch( TextInput1.Text, "hello", Contains )	 // false

// Tests whether the user's input contains the word "hello" (case insensitive).	
IsMatch( TextInput1.Text, "hello", Contains & IgnoreCase )	 // true

// Matches a United States Social Security Number	
IsMatch( "123-45-7890", Digit & Digit & Digit & Hyphen & Digit & Digit & Hyphen & Digit & Digit & Digit & Digit )	 // true

// Matches a sequence of digits, a period, and then zero or more digits.	
IsMatch( "123.456", MultipleDigits & Period & OptionalDigits ) // true

// Matches an integer greater than zero 
IsMatch( "986", "\d+" )		// true
```

### Collect, Clear, and ClearCollect
<https://learn.microsoft.com/en-us/power-platform/power-fx/reference/function-clear-collect-clearcollect>

```js
// write data into datasource
Collect('YourDataSource', {Title: 'First Try', StartDate: Today()})
Collect('YourDataSource', colMyCollection)
```

### Filter
```js
// To show all rows when no categories are selected, you could add an IsEmpty check
Filter(
  Accounts, Category in ComboBoxCategory.SelectedItems
  || IsEmpty(ComboBoxCategory.SelectedItems)
)

// You could use this Dataverse view named Monday Delivery by using the following Filter() function:
Filter(
  Accounts,
  'Accounts (Views)'.'Monday Delivery'
)
```
### Patch

If your table column uses a Choice set, when you use Patch, you'll need to prefix your value with the Choice set name, else you'll get an 'OptionSetValue' error. You can learn what the Choice set name is by going to your Table in Dataverse, selecting that column in Edit mode, and looking for the field Sync this choice with. Just below that column will be the name of the Choice set. More info can be found [here](https://learn.microsoft.com/en-us/training/modules/choice-columns-formulas/3-set-values)
```js
// Update the Assets Category with the selected gallery item 
Patch(Assets,ThisItem,{Category: 'Category (Assets)'.Appliance})
```
![](image/20240804094827.png)


## Data Type

### Color
`Color.Red`, `ColorValue("#102030")`, `RGBA( 255, 128, 0, 0.5)`

### Record
a Record: 
`{ Company: "Northwind Traders", Staff: 35, NonProfit: false }`
Record Reference: `First(Accounts).Owner`

### Table
```js
Table( 
  {FirstName: "Sidney", LastName: "Higa" }, 
  { FirstName: "Nancy", LastName: "Anderson" }
)
```

### Untyped object
`ParseJSON("{ ""Field"" : 1234 }").Field`

This will display a notification message in top banner
`Notify( "Jane said ""Hello, World!""" )`

### String Interpolation

```js
// assume Apples = 3, Bananas =4
$"We have {Apples} apples, {Bananas} bananas"
//>> Output: We have 3 apples, 4 bananas
```

### Image

Three way to reference a Image
Add the image into "Media" with Images name as "NokiaBlue", then reference to its name
```js
Image = NokiaBlue
```
Add the Base64 string code, such as
```js
Image = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAkAAAAFAQMAAA ... sample data"
```
Add the hypelink to image

```js
Image = '"https://github.com/james3619/pictures/blob/main/Win%20(1).jpg?raw=true"'
```

### Convert to UTC

```js
// China Local Time: Jul 31, 2024 8:40:00 PM >> UTC: Jul 31, 2024 12:40:00 PM
Text(DateAdd( Now(), TimeZoneOffset(), TimeUnit.Minutes ),DateTimeFormat.LongDateTime)
```

### Datetime handling
* Use the `DateAdd` and `DateDiff` functions to add or subtract from one of these values
* Adding and subtracting date and time values directly isn't recommended


## Control

### Control's naming convention

![](image/20240809091956.png)

### Dropdown, ComboBox

Fill in the dropdown list from SharePoint List

```js
// Asset is SPO List name, while Location is a lookup field
Items = Choices(Asset.Location)

// similar for ListBox, when it need to be filled by a `Choice` Column
Items = Choices(Asset.Brand)
```

**This example show the selectedItem with multiply values**

DataSource: `IceCream` list in SharePoint
place a ComboBox in screen

```js 
Items = Choices(IceCream.Person)
SearchFields = ["DisplayName"]
DisplayFields = ["DisplayName"]
```
place a label
```js
With(
    {varSelectedValues: ComboBox1.SelectedItems},
    Concat(
        varSelectedValues,
        DisplayName,
        " , "
    )
)
```
![](image/20240810082715.png)

### gallery

Show list columns in a gallery
* For a Choice or Lookup column, specify `ThisItem.ColumnName.Value` to show data in that column
* For a Person or Group column, specify `ThisItem.ColumnName.DisplayName` to show the display name of the user or the group.

### Form

To enable a button to save changes only when the data in a form is valid but hasn't yet been submitted, set the button's DisplayMode property to this formula:

```js
SubmitButton.DisplayMode = If(IsBlank( Form.Error ) || Form.Valid, DisplayMode.Edit, DisplayMode.Disabled)
```

## Connector

* [Office 365 User Connector](https://learn.microsoft.com/en-us/power-apps/maker/canvas-apps/connections/connection-office365-users)
* [Use Office 365 Outlook connector](https://learn.microsoft.com/en-us/connectors/office365connector/#actions) - Functions includes "Send email", "Export email" etc.

#### Send email

> Syntax
> Office365Outlook.SendEmailV2(To, Subject, Body)

```js
// example
Office365Outlook.SendEmailV2(User().Email, "Subject of the email", "Body of the email")
```












